{
  "annotations": {"list": []},
  "description": "The Four Golden Signals: Latency, Traffic, Errors, Saturation",
  "editable": true,
  "graphTooltip": 1,
  "panels": [
    {
      "gridPos": {"h": 2, "w": 24, "x": 0, "y": 0},
      "id": 1,
      "options": {
        "content": "# Golden Signals\nThe four key metrics for monitoring distributed systems: **Latency**, **Traffic**, **Errors**, and **Saturation**.",
        "mode": "markdown"
      },
      "type": "text"
    },
    {
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 2},
      "id": 2,
      "title": "üìä Latency",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource}"},
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"drawStyle": "line", "fillOpacity": 10, "lineWidth": 2},
          "unit": "s"
        }
      },
      "gridPos": {"h": 6, "w": 12, "x": 0, "y": 3},
      "id": 3,
      "title": "Request Latency (p50, p95, p99)",
      "type": "timeseries",
      "targets": [
        {"expr": "histogram_quantile(0.50, sum(rate(http_request_duration_seconds_bucket{namespace=~\"$namespace\"}[5m])) by (le))", "legendFormat": "p50", "refId": "A"},
        {"expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{namespace=~\"$namespace\"}[5m])) by (le))", "legendFormat": "p95", "refId": "B"},
        {"expr": "histogram_quantile(0.99, sum(rate(http_request_duration_seconds_bucket{namespace=~\"$namespace\"}[5m])) by (le))", "legendFormat": "p99", "refId": "C"}
      ]
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource}"},
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"drawStyle": "line", "fillOpacity": 10},
          "unit": "s"
        }
      },
      "gridPos": {"h": 6, "w": 12, "x": 12, "y": 3},
      "id": 4,
      "title": "Latency by Service",
      "type": "timeseries",
      "targets": [
        {"expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{namespace=~\"$namespace\"}[5m])) by (le, service))", "legendFormat": "{{service}}", "refId": "A"}
      ]
    },
    {
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 9},
      "id": 5,
      "title": "üö¶ Traffic",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource}"},
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"drawStyle": "line", "fillOpacity": 20},
          "unit": "reqps"
        }
      },
      "gridPos": {"h": 6, "w": 12, "x": 0, "y": 10},
      "id": 6,
      "title": "Request Rate",
      "type": "timeseries",
      "targets": [
        {"expr": "sum(rate(http_requests_total{namespace=~\"$namespace\"}[5m]))", "legendFormat": "Total RPS", "refId": "A"}
      ]
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource}"},
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"drawStyle": "bars", "fillOpacity": 80},
          "unit": "reqps"
        }
      },
      "gridPos": {"h": 6, "w": 12, "x": 12, "y": 10},
      "id": 7,
      "title": "Request Rate by Service",
      "type": "timeseries",
      "targets": [
        {"expr": "sum(rate(http_requests_total{namespace=~\"$namespace\"}[5m])) by (service)", "legendFormat": "{{service}}", "refId": "A"}
      ]
    },
    {
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 16},
      "id": 8,
      "title": "‚ùå Errors",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource}"},
      "fieldConfig": {
        "defaults": {
          "color": {"fixedColor": "red", "mode": "fixed"},
          "custom": {"drawStyle": "line", "fillOpacity": 30},
          "unit": "percentunit"
        }
      },
      "gridPos": {"h": 6, "w": 12, "x": 0, "y": 17},
      "id": 9,
      "title": "Error Rate",
      "type": "timeseries",
      "targets": [
        {"expr": "sum(rate(http_requests_total{status=~\"5..\", namespace=~\"$namespace\"}[5m])) / sum(rate(http_requests_total{namespace=~\"$namespace\"}[5m]))", "legendFormat": "5xx Error Rate", "refId": "A"}
      ]
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource}"},
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"drawStyle": "line", "fillOpacity": 10},
          "unit": "short"
        }
      },
      "gridPos": {"h": 6, "w": 12, "x": 12, "y": 17},
      "id": 10,
      "title": "Errors by Status Code",
      "type": "timeseries",
      "targets": [
        {"expr": "sum(rate(http_requests_total{status=~\"[45]..\", namespace=~\"$namespace\"}[5m])) by (status)", "legendFormat": "{{status}}", "refId": "A"}
      ]
    },
    {
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 23},
      "id": 11,
      "title": "üíæ Saturation",
      "type": "row"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource}"},
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"drawStyle": "line", "fillOpacity": 10},
          "unit": "percentunit",
          "max": 1
        }
      },
      "gridPos": {"h": 6, "w": 12, "x": 0, "y": 24},
      "id": 12,
      "title": "CPU Utilization",
      "type": "timeseries",
      "targets": [
        {"expr": "sum(rate(container_cpu_usage_seconds_total{namespace=~\"$namespace\"}[5m])) by (pod) / sum(kube_pod_container_resource_limits{resource=\"cpu\", namespace=~\"$namespace\"}) by (pod)", "legendFormat": "{{pod}}", "refId": "A"}
      ]
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource}"},
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "palette-classic"},
          "custom": {"drawStyle": "line", "fillOpacity": 10},
          "unit": "percentunit",
          "max": 1
        }
      },
      "gridPos": {"h": 6, "w": 12, "x": 12, "y": 24},
      "id": 13,
      "title": "Memory Utilization",
      "type": "timeseries",
      "targets": [
        {"expr": "sum(container_memory_working_set_bytes{namespace=~\"$namespace\"}) by (pod) / sum(kube_pod_container_resource_limits{resource=\"memory\", namespace=~\"$namespace\"}) by (pod)", "legendFormat": "{{pod}}", "refId": "A"}
      ]
    }
  ],
  "refresh": "30s",
  "schemaVersion": 38,
  "tags": ["golden-signals", "sre"],
  "templating": {
    "list": [
      {"name": "datasource", "query": "prometheus", "type": "datasource"},
      {"datasource": {"type": "prometheus", "uid": "${datasource}"}, "definition": "label_values(http_requests_total, namespace)", "includeAll": true, "multi": true, "name": "namespace", "query": "label_values(http_requests_total, namespace)", "type": "query"}
    ]
  },
  "time": {"from": "now-6h", "to": "now"},
  "title": "Golden Signals",
  "uid": "golden-signals",
  "version": 1
}
